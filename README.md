# Sunguard - 햇빛을 피하는 가장 스마트한 방법

<br>

## 프로젝트 개요

**Sunguard**는 버스 이용 시 사용자가 햇빛을 피해 쾌적하게 이동할 수 있도록 **최적의 좌석을 추천**해주는 백엔드 API 프로젝트입니다.

### 개발 동기
매일 버스를 이용하며 햇빛 때문에 불편했던 개인적인 경험에서 시작되었습니다. 시간에 따라 햇빛이 강하게 들어오는 자리에 앉게되면 눈이 부시거나 더위를 느끼는 경우가 많았습니다. '버스의 진행 방향과 현재 시간만 알면 태양의 위치를 파악해서 햇빛이 들지 않는 좌석을 알 수 있지 않을까?' 라는 아이디어에서 이 프로젝트를 구체화하게 되었습니다. 단순한 길찾기를 넘어, 사용자의 '이동 경험' 자체를 개선하는 것을 목표로 삼았습니다.

<br>

## 기술 스택

**Backend**
| 기술 | 설명 |
| :--- | :--- |
| ![Java 17](https://img.shields.io/badge/Java%2017-007396?style=flat-square&logo=java&logoColor=white) | 안정성과 풍부한 생태계를 기반으로 백엔드 로직을 구현했습니다. |
| ![Spring Boot 3.2.10](https://img.shields.io/badge/Spring%20Boot-6DB33F?style=flat-square&logo=spring-boot&logoColor=white) | MSA 구조에 적합하며, 빠르고 간편한 서버 구축을 위해 사용했습니다. |
| ![Spring Security](https://img.shields.io/badge/Spring%20Security-6DB33F?style=flat-square&logo=spring-security&logoColor=white) | JWT와 OAuth2를 이용해 안전한 사용자 인증/인가 시스템을 구축했습니다. |
| ![Spring Data JPA](https://img.shields.io/badge/Spring%20Data%20JPA-6DB33F?style=flat-square&logo=spring&logoColor=white) | 객체 지향적으로 데이터베이스를 관리하고 생산성을 높였습니다. |

**Database**
| 기술 | 설명 |
| :--- | :--- |
| ![MariaDB](https://img.shields.io/badge/MariaDB-003545?style=flat-square&logo=mariadb&logoColor=white) | 버스 노선, 정류장 등 정적인 데이터를 안정적으로 저장하고 관리합니다. |
| ![Redis](https://img.shields.io/badge/Redis-DC382D?style=flat-square&logo=redis&logoColor=white) | 자주 사용되는 경로 데이터 캐싱 및 Refresh Token 관리를 통해 응답 속도를 높였습니다. |

**DevOps**
| 기술 | 설명 |
| :--- | :--- |
| ![AWS](https://img.shields.io/badge/AWS-232F3E?style=flat-square&logo=amazon-aws&logoColor=white) | EC2, RDS, ElastiCache, Parameter Store를 활용하여 인프라를 구축하고 운영합니다. |
| ![Nginx](https://img.shields.io/badge/nginx-%23009639.svg?style=flat-square&logo=nginx&logoColor=white) | HTTPS 통신(SSL/TLS)을 위한 리버스 프록시 서버로 사용했습니다. |
| ![Gradle](https://img.shields.io/badge/Gradle-02303A?style=flat-square&logo=gradle&logoColor=white) | 프로젝트의 의존성을 효율적으로 관리했습니다. |

<br>

## 아키텍처

<img width="2551" height="1294" alt="Image" src="https://github.com/user-attachments/assets/7fad55ad-e770-41e5-a7e1-f318ab7da3d0" />

<br>

## ✨ 주요 기능

### 1. 햇빛 회피 좌석 추천
- **핵심 기능**: 사용자의 탑승 시간과 버스의 진행 방향을 기반으로 태양의 고도와 방위각을 계산합니다.
- **구현**: 계산된 태양 위치를 통해 햇빛이 직접 닿지 않는 최적의 좌석(좌/우, 앞/뒤)을 추천합니다.
- **기대 효과**: 사용자는 버스에서 눈부심이나 더위 없이 쾌적한 이동을 경험할 수 있습니다.


### 2. A* 알고리즘 기반 최적 경로 탐색
- **문제 해결**: 실제 버스 노선 데이터와 정류장의 위치 데이터를 기반으로 가장 효율적인 환승 경로를 제공해야 했습니다.
- **구현**: 그래프 탐색 알고리즘인 **A* (A-star) 알고리즘**을 도입하여, 각 정류장(노드) 간의 비용(거리)을 계산하고 최적의 경로를 탐색하는 로직을 구현했습니다.
- **성과**: 복잡한 버스 노선망에서도 빠르고 정확한 경로 및 추천좌석을 사용자에게 제공할 수 있게 되었습니다.


### 3. 실시간 버스 정보 제공 및 캐싱
- **구현**: 부산시 공공데이터 포털의 버스 도착 정보 API를 `WebFlux`를 사용하여 호출하고, 결과를 파싱하여 사용자에게 제공합니다.
- **성능 개선**: 자주 조회되는 버스 노선 데이터는 **InMemory 전략으로 캐싱**하여 API 호출을 최소화하고 응답 속도를 획기적으로 개선했습니다.

### 4. JWT & OAuth2 기반 사용자 인증
- **구현**: Spring Security를 활용하여 JWT(JSON Web Token) 기반의 자체 인증 시스템과 OAuth2 (GitHub) 소셜 로그인을 구현했습니다.
- **기능**: 인증된 사용자는 즐겨찾는 노선, 정류장 등의 개인화된 기능을 이용할 수 있습니다.

<br>

## 📚 배우고 느낀 점

### 문제 해결 과정: 경로 탐색 성능 개선기
초기에는 모든 정류장을 데이터베이스에서 조회하여 경로를 계산하는 방식의 성능이 만족스럽지 못했습니다. 이를 해결하기 위해 두 단계의 개선을 진행했습니다.

1.  **A* 알고리즘 도입**: 첫 번째로, 더 효율적인 경로 탐색을 위해 휴리스틱 기반의 A* 알고리즘을 학습하고 적용했습니다. 이 과정에서 자료구조와 알고리즘의 중요성을 다시 한번 깨달았으며, 복잡한 문제를 논리적으로 분해하고 해결하는 능력을 길렀습니다.
2.  **인메모리 캐싱**: 두 번째로, 알고리즘을 개선했음에도 여전히 DB I/O가 성능에 영향을 준다는 점을 파악했습니다. 자주 사용되지만 변경 빈도가 거의 없는 버스 노선 데이터를 JVM의 Heap영역에 캐싱하여 메모리 상에서 처리하도록 구조를 변경했습니다. 그 결과, 응답 속도를 크게 향상시킬 수 있었고, 부하 테스트를 통해 캐시의 효율성을 직접 확인할 수 있었습니다.

이 경험을 통해, 단순히 기능을 구현하는 것을 넘어 **성능 병목 지점을 찾아내고, 적절한 기술(알고리즘, 캐시)을 선택하여 시스템을 최적화**하는 실질적인 역량을 갖추게 되었습니다.

### 향후 계획
- **환승 알고리즘 개선**: 아직 완벽한 경로탐색과 환승 알고리즘이 되기까지 미흡한 부분이 있어 보완 계획을 가지고 있습니다.
1.  도보 환승 최적화
      환승 시 승·하차 인구가 많은 정류장도 고려하여, 
      도보 이동 환승이 최적의 경로가 될 수 있으면, 이러한 경로도 제안 받을 수 있게 개선할 계획입니다.
2. 경로 탐색의 조기 종료
      탐색 과정에서 노선 경로 리스트에 목적지가 포함된 경우,
      불필요한 추가 탐색을 중단하여 응답 속도와 효율성을 높일 계획입니다.
2-1. 탐색의 조기 종료 시 샘플링 기반 다중 노선 처리
      목적지가 포함된 노선이 여러 개일 경우,
      각 노선별 목적지까지의 실거리를 샘플링 기법으로 일부만 계산하여 처리량을 줄입니다.
      이후 실제 이동 거리가 가장 짧은 노선을 선택해 최적 경로를 추천하도록 개선할 예정입니다.
  
- **프론트엔드 개발**: 사용자가 직접 상호작용할 수 있는 웹 또는 모바일 애플리케이션을 구축하여 완전한 서비스를 제공하고 싶습니다.
